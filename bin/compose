#!/usr/bin/env bash



# Default image tag
IMAGE_TAG="dev"

# Parse command line arguments
while [[ $# -gt 0 ]]; do
    case "$1" in
        -t|--tag)
            IMAGE_TAG="$2"
            shift 2
            ;;
        *)
            break
            ;;
    esac
done

H3XRECON_DOCKER_REGISTRY=$(cat .current_registry)
export H3XRECON_DOCKER_REGISTRY
set -a && . ./.env.compose; export IMAGE_TAG && set +a
# If no arguments remain, default to up and logs
if [ $# -eq 0 ]; then
    docker compose -f docker-compose.local.yaml up -d && docker compose -f docker-compose.local.yaml logs -f
else
    # Pass remaining args to docker compose
    docker compose -f docker-compose.local.yaml "$@"
fi